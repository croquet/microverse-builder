"use strict";(globalThis.webpackChunk_croquet_microverse=globalThis.webpackChunk_croquet_microverse||[]).push([[8666],{8666:(s,e,t)=>{t.r(e),t.d(e,{default:()=>i});const i={modules:[{name:"Bridge",actorBehaviors:[class BridgeActor{setup(){this.dimension=9,this.ms=[...Array(this.dimension).keys()].map(e=>[...Array(this.dimension).keys()].map(s=>({x:s,y:e,m:1,a:[0,0,0],v:[0,0,0],p:[+s,0,+e]}))),this.springs=[];for(let e=0;e<this.dimension;e++)for(let s=0;s<this.dimension;s++)s!==this.dimension-1&&this.springs.push({length:1,naturalLength:1,s0:this.ms[e][s],s1:this.ms[e][s+1]}),e!==this.dimension-1&&this.springs.push({length:1,naturalLength:1,s0:this.ms[e][s],s1:this.ms[e+1][s]});this.addEventListener("click","sag"),this.stepping||(console.log("new step"),this.stepping=!0,this.step())}step(){if(this.stepping){let i=this.dimension;for(let e=0;e<this.dimension;e++)for(let s=0;s<this.dimension;s++)this.ms[e][s].a=[0,-1e-4,0];let r=s=>{let e=Number.isNaN;return e(s[0])||e(s[1])||e(s[2])};var o,n,a=s=>r(s.a)||r(s.v)||r(s.p);for(let t=0;t<this.springs.length;t++){var h=this.springs[t];let s=h.s0,e=h.s1;var l=s.p,d=e.p,d=[d[0]-l[0],d[1]-l[1],d[2]-l[2]],l=Worldcore.v3_magnitude(d)-h.naturalLength,h=Worldcore.v3_scale(d,.8*l),d=Worldcore.v3_scale(d,.8*-l);r(h)||r(d)||a(s)||a(e),s.a=Worldcore.v3_add(s.a,h),e.a=Worldcore.v3_add(e.a,d)}for(let t=0;t<this.dimension;t++)for(let e=0;e<this.dimension;e++){let s=this.ms[t][e];o=e,n=t,0===o&&0===n||0===o&&n===i-1||o===i-1&&0===n||o===i-1&&n===i-1?s.v=[0,0,0]:s.v=Worldcore.v3_add(s.v,s.a),s.v=Worldcore.v3_scale(s.v,.99),s.p=Worldcore.v3_add(s.p,s.v)}this.say("updateDisplay"),this.future(20).step()}}sag(){var s=this.dimension;console.log(s),s=Math.floor(s/2);let e=this.ms[s][s];e.v=Worldcore.v3_add(e.v,[0,.02,0]),window.middle=e,console.log("sag",e)}}],pawnBehaviors:[class BridgePawn{setup(){let r=this.actor.dimension||9;if(this.group||(this.group=new Worldcore.THREE.Group,this.group.name="Bridge"),this.spheres)for(let s=0;s<this.spheres.length;s++){var e=this.spheres[s];for(let s=0;s<r;s++)this.group.remove(e[s]);this.group.children=[]}this.spheres=[...Array(r).keys()].map(i=>[...Array(r).keys()].map(s=>{var e=new Worldcore.THREE.SphereGeometry(.1,16,16),s=new Worldcore.THREE.MeshStandardMaterial({color:s/r*200*65536+i/r*201});let t=new Worldcore.THREE.Mesh(e,s);return this.group.add(t),t.castShadow=!0,t})),this.renderObject.add(this.group),this.listen("updateDisplay","updateDisplay"),this.removeEventListener("pointerDoubleDown","onPointerDoubleDown"),this.addEventListener("pointerDoubleDown","nop")}updateDisplay(){var e=this.actor.ms;if(e)for(let s=0;s<e.length;s++){var t=this.spheres[s],i=e[s];for(let e=0;e<i.length;e++){var r=i[e];let s=t[e];s||console.log("masses and spheres mismatch"),s.position.set(...r.p)}}}}]}]}}}]);